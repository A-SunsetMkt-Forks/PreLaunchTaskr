<?xml version="1.0" encoding="utf-8" ?>
<Page
    x:Class="PreLaunchTaskr.GUI.WinUI3.Views.ProgramConfigPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="using:PreLaunchTaskr.GUI.WinUI3.Views"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:my="using:PreLaunchTaskr.GUI.WinUI3.Controls"
    xmlns:vm="using:PreLaunchTaskr.GUI.WinUI3.ViewModels.ItemModels"
    Loaded="Page_Loaded"
    mc:Ignorable="d">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <my:MyGrid
            Grid.Row="0"
            Margin="36,36,36,18"
            ContentVerticalAlignment="Center"
            RowSpacing="24">

            <my:MyGrid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="auto" />
            </my:MyGrid.ColumnDefinitions>

            <StackPanel
                Grid.Column="0"
                Orientation="Horizontal"
                Spacing="16">

                <Image Source="{x:Bind viewModel.Icon}" />

                <StackPanel>
                    <TextBlock Style="{ThemeResource SubtitleTextBlockStyle}" Text="{x:Bind viewModel.Name}" />
                    <TextBlock
                        Opacity="0.5"
                        Style="{ThemeResource BodyTextBlockStyle}"
                        Text="{x:Bind viewModel.Path}" />
                    <!--<ToggleSwitch IsOn="{x:Bind viewModel.Enabled, Mode=TwoWay}" />-->
                </StackPanel>
            </StackPanel>

            <StackPanel
                Grid.Column="1"
                Orientation="Horizontal"
                Spacing="8">

                <DropDownButton>
                    <TextBlock Text="启动" />

                    <DropDownButton.Flyout>
                        <MenuFlyout Placement="Bottom">
                            <MenuFlyoutItem
                                Click="Launch_Click"
                                DataContext="{x:Bind viewModel.ProgramListItem}"
                                Text="启动">
                                <MenuFlyoutItem.Icon>
                                    <SymbolIcon Symbol="Go" />
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                            <MenuFlyoutItem
                                Click="LaunchAsAdmin_Click"
                                DataContext="{x:Bind viewModel.ProgramListItem}"
                                Text="以管理员身份启动">
                                <MenuFlyoutItem.Icon>
                                    <SymbolIcon Symbol="Admin" />
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                        </MenuFlyout>
                    </DropDownButton.Flyout>
                </DropDownButton>

                <Button
                    Click="{x:Bind viewModel.SaveChanges}"
                    Content="立即应用设置"
                    Style="{ThemeResource AccentButtonStyle}" />
            </StackPanel>
        </my:MyGrid>

        <NavigationView
            x:Name="CategoryNavigation"
            Grid.Row="1"
            x:FieldModifier="private"
            IsBackButtonVisible="Collapsed"
            IsBackEnabled="False"
            IsSettingsVisible="False"
            MenuItemsSource="{x:Bind viewModel.Categories}"
            PaneDisplayMode="Top"
            SelectionChanged="CategoryNavigation_SelectionChanged">

            <NavigationView.PaneHeader>
                <Border Width="18" />
            </NavigationView.PaneHeader>

            <NavigationView.PaneFooter>
                <Border Width="18" />
            </NavigationView.PaneFooter>

            <NavigationView.MenuItemTemplate>
                <DataTemplate x:DataType="vm:ProgramConfigCategoryItem">
                    <NavigationViewItem Content="{x:Bind Name}" />
                </DataTemplate>
            </NavigationView.MenuItemTemplate>

            <Frame
                x:Name="ContentFrame"
                x:FieldModifier="private"
                IsNavigationStackEnabled="False" />

        </NavigationView>
    </Grid>
</Page>
